# ServiceSlicer Frontend

React + TypeScript frontend application for ServiceSlicer, a tool for analyzing Java monolithic applications and suggesting microservice boundaries.

## Features

### Project Management
- **Create Projects**: Upload JAR files and optional source code (ZIP) for analysis
- **View Projects**: Browse all analysis projects
- **Project Details**: View dependency graphs and decomposition results from 5 different algorithms:
  - Label Propagation
  - Louvain
  - Leiden
  - Domain-Driven Decomposition
  - Actor-Driven Decomposition

### Load Test Experiments
- **Create Experiments**: Set up performance comparison experiments
- **Configure Systems**: Add multiple systems under test (e.g., monolith vs microservices)
- **Upload Artifacts**: Upload docker-compose files, JAR files, and OpenAPI specifications
- **View Results**: Compare performance metrics across different decomposition strategies

## Tech Stack

- **React 18** - UI library
- **TypeScript** - Type safety
- **Vite** - Build tool and dev server
- **React Router v6** - Client-side routing
- **TanStack Query** - Server state management
- **React Hook Form** - Form handling
- **Zod** - Schema validation
- **Tailwind CSS** - Styling
- **Shadcn/ui** - UI components
- **Axios** - HTTP client

## Getting Started

### Prerequisites

- Node.js 18+ and npm
- Backend API running on `http://localhost:8080`

### Installation

```bash
# Install dependencies
npm install
```

### API Client Generation

This project uses **Orval** to auto-generate TypeScript API client code from the backend's OpenAPI specification.

**Important**: Before starting development, generate the API client:

```bash
# 1. Ensure backend is running on http://localhost:8080
cd ../backend && mvn spring-boot:run

# 2. Generate API client (in a new terminal)
cd frontend
npm run generate:api
```

This creates type-safe React Query hooks and TypeScript types in `src/api/generated/`.

ðŸ“– See [CODEGEN.md](./CODEGEN.md) for detailed instructions.

**When to regenerate**: Run `npm run generate:api` whenever the backend API changes.

### Configuration

Create a `.env` file (or use the provided `.env.example`):

```env
VITE_API_BASE_URL=/api
```

### Development

```bash
# Start development server on http://localhost:3000
npm run dev
```

The dev server includes a proxy configuration that forwards `/api/*` requests to `http://localhost:8080`.

### Build

```bash
# Build for production
npm run build

# Preview production build
npm run preview
```

### Linting

```bash
npm run lint
```

## Project Structure

```
src/
â”œâ”€â”€ api/              # API client and HTTP calls
â”‚   â”œâ”€â”€ generated/    # ðŸ¤– Auto-generated by Orval (run npm run generate:api)
â”‚   â”‚   â”œâ”€â”€ model/    # TypeScript types from OpenAPI
â”‚   â”‚   â”œâ”€â”€ projects/ # Project API hooks
â”‚   â”‚   â”œâ”€â”€ experiments/ # Experiment API hooks
â”‚   â”‚   â””â”€â”€ files/    # File API hooks
â”‚   â”œâ”€â”€ client.ts     # Axios instance (used by generated code)
â”‚   â”œâ”€â”€ files.ts      # Custom file upload logic (3-step flow)
â”‚   â”œâ”€â”€ projects.ts   # [To be replaced by generated code]
â”‚   â””â”€â”€ experiments.ts # [To be replaced by generated code]
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/           # Reusable UI components (Shadcn)
â”‚   â””â”€â”€ layout/       # Layout components (header, nav, etc.)
â”œâ”€â”€ hooks/            # Custom React hooks
â”‚   â”œâ”€â”€ useFileUpload.ts   # File upload with 3-step flow
â”‚   â”œâ”€â”€ useProjects.ts     # React Query hooks for projects
â”‚   â””â”€â”€ useExperiments.ts  # React Query hooks for experiments
â”œâ”€â”€ lib/              # Utility functions
â”‚   â””â”€â”€ utils.ts      # Class merging (cn), etc.
â”œâ”€â”€ pages/            # Page components
â”‚   â”œâ”€â”€ projects/
â”‚   â”‚   â”œâ”€â”€ ProjectListPage.tsx
â”‚   â”‚   â”œâ”€â”€ ProjectDetailPage.tsx
â”‚   â”‚   â””â”€â”€ ProjectCreatePage.tsx
â”‚   â””â”€â”€ experiments/
â”‚       â”œâ”€â”€ ExperimentListPage.tsx
â”‚       â”œâ”€â”€ ExperimentDetailPage.tsx
â”‚       â””â”€â”€ ExperimentCreatePage.tsx
â”œâ”€â”€ styles/           # Global styles
â”‚   â””â”€â”€ index.css     # Tailwind imports and theme
â”œâ”€â”€ types/            # TypeScript type definitions
â”‚   â””â”€â”€ api.ts        # API request/response types
â”œâ”€â”€ App.tsx           # Root component with routes
â””â”€â”€ main.tsx          # Application entry point
```

## API Integration

The frontend communicates with the Spring Boot backend via REST API using **auto-generated TypeScript client code**:

### Code Generation (Orval)
- **Source**: OpenAPI spec at `http://localhost:8080/v3/api-docs`
- **Output**: Type-safe React Query hooks in `src/api/generated/`
- **Regenerate**: `npm run generate:api` (after backend changes)

### Available Endpoints

### File Upload Flow
1. `POST /files` - Initiate upload, get presigned URL
2. `PUT <uploadUrl>` - Upload file to storage
3. `POST /files/{fileId}/complete` - Mark upload complete
4. `POST /files/{fileId}/extract` - Extract ZIP files (optional)

### Projects
- `GET /projects` - List all projects
- `POST /projects` - Create new project
- `GET /projects/{id}` - Get project details
- `POST /projects/{id}/graph` - Rebuild dependency graph

### Experiments
- `GET /load-tests/experiments` - List all experiments
- `POST /load-tests/experiments` - Create new experiment
- `GET /load-tests/experiments/{id}` - Get experiment details

## Key Features

### Auto-Generated API Client
- **Orval** generates TypeScript types and React Query hooks from OpenAPI spec
- Type-safe API calls prevent runtime errors
- Automatic sync between backend and frontend types
- Run `npm run generate:api` to regenerate after backend changes

### Responsive File Upload
The `useFileUpload` hook handles the complete 3-step file upload process with progress tracking and error handling.

### Form Validation
All forms use React Hook Form with Zod schema validation for type-safe, validated inputs.

### Optimistic UI Updates
React Query automatically manages cache invalidation and refetching after mutations.

### Error Handling
Toast notifications provide user feedback for all operations (success, error, loading states).

## Development Notes

- **API Client Generation**: Run `npm run generate:api` after backend API changes to regenerate types and hooks
- The proxy configuration in `vite.config.ts` forwards API requests to the backend
- TypeScript types are auto-generated from OpenAPI spec (no manual `src/types/api.ts` needed)
- Generated code is in `src/api/generated/` (gitignored, regenerate locally)
- All UI components follow the Shadcn/ui design system
- Loading states and error boundaries are implemented on all pages
- The Orval config (`orval.config.ts`) uses the existing `src/api/client.ts` as the HTTP client mutator
